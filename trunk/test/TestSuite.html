<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>

	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<title>Crypto-JS Test Suite</title>

	<!-- YUI seed file -->
	<script src="http://yui.yahooapis.com/3.0.0/build/yui/yui-min.js"></script>

	<!-- Customized styles -->
	<style type="text/css">

		/* Enlarge body */
		.yui-skin-sam .yui-console {
			width: 600px !important;
		}
		.yui-skin-sam .yui-console-bd {
			height: 452px !important;
		}

		/* Hide irrelevant data */
		.yui-skin-sam .yui-console-entry-info,
		.yui-skin-sam .yui-console-entry-src,
		.yui-skin-sam .yui-console-entry-time {
			display: none;
		}

		/* Minimize meta and content */
		.yui-skin-sam .yui-console-entry-meta,
		.yui-skin-sam .yui-console-entry-content {
			float: left;
		}
		.yui-skin-sam .yui-console-entry {
			padding: 0.5ex;
			min-height: 0 !important;
			overflow: auto;
		}

		/* Color pass and fail */
		.yui-skin-sam .yui-console-entry-pass .yui-console-entry-cat {
			background: green;
			color: white;
		}
		.yui-skin-sam .yui-console-entry-fail .yui-console-entry-cat {
			background: red;
			color: white;
		}

	</style>

	<!-- Crypto-JS source files -->
	<script src="../src/Crypto.js"></script>
	<script src="../src/Util.js"></script>
	<script src="../src/Hex.js"></script>
	<script src="../src/Base64.js"></script>
	<script src="../src/SHA1.js"></script>

	<script type="text/javascript">

		YUI().use("test", "console", function(Y) {

			// Crypto.util test cases
			Y.Test.Runner.add(new Y.Test.Case({

				"test util.u32": function() {
					Y.Assert.areEqual(2147483647, Crypto.util.u32(2147483647));
					Y.Assert.areEqual(2147483646, Crypto.util.u32(2147483646));
					Y.Assert.areEqual(2, Crypto.util.u32(2));
					Y.Assert.areEqual(1, Crypto.util.u32(1));
					Y.Assert.areEqual(0, Crypto.util.u32(0));
					Y.Assert.areEqual(4294967295, Crypto.util.u32(-1));
					Y.Assert.areEqual(4294967294, Crypto.util.u32(-2));
					Y.Assert.areEqual(2147483649, Crypto.util.u32(-2147483647));
					Y.Assert.areEqual(2147483648, Crypto.util.u32(-2147483648));
				},

				"test util.add": function() {
					Y.Assert.areEqual(0, Crypto.util.add(4294967295, 1));
					Y.Assert.areEqual(2147483648, Crypto.util.add(2147483647, 1));
					Y.Assert.areEqual(2147483647, Crypto.util.add(4294967295, 2147483647, 1));
				},

				"test util.mult": function() {
					Y.Assert.areEqual(1, Crypto.util.mult(4294967295, 4294967295));
					Y.Assert.areEqual(0, Crypto.util.mult(2147483648, 2147483648));
					Y.Assert.areEqual(3817748708, Crypto.util.mult(2863311530, 2863311530));
				},

				"test util.gt": function() {
					Y.Assert.isTrue(Crypto.util.gt(-1, 1));
				},

				"test util.lt": function() {
					Y.Assert.isTrue(Crypto.util.lt(1, -1));
				},

				"test util.rotl": function() {
					Y.Assert.areEqual(0x00FF00AA, Crypto.util.rotl(0xAA00FF00, 8));
				},

				"test util.rotr": function() {
					Y.Assert.areEqual(0x00AA00FF, Crypto.util.rotr(0xAA00FF00, 8));
				},

				"test util.endian": function() {
					Y.Assert.areEqual(0xF0E0C080, Crypto.util.u32(Crypto.util.endian(0x80C0E0F0)));
					Y.Assert.areEqual(0x80C0E0F0, Crypto.util.u32(Crypto.util.endian(Crypto.util.endian(0x80C0E0F0))));
				},

				"test util.randomWords": function() {
					Y.Assert.areEqual(8, Crypto.util.randomWords(8).length);
					Y.Assert.areNotEqual(Crypto.util.randomWords(8).toString(), Crypto.util.randomWords(8).toString());
				}

			}));

			// Crypto.enc test cases
			Y.Test.Runner.add(new Y.Test.Case({

				"test enc.ByteStr.encode": function() {
					Y.Assert.areEqual("Hello, World!", Crypto.enc.ByteStr.encode(Crypto.enc.ByteStr.decode("Hello, World!")));
				},

				"test enc.ByteStr.decode": function() {
					Y.Assert.areEqual([0x48656C6C, 0x6F2C2057, 0x6F726C64, 0x21000000].toString(), Crypto.util.u32(Crypto.enc.ByteStr.decode("Hello, World!")).toString());
				},

				"test enc.UTF8.encode": function() {
					Y.Assert.areEqual("\u0041\u2262\u0391\u002E", Crypto.enc.UTF8.encode(Crypto.enc.UTF8.decode("\u0041\u2262\u0391\u002E")));
					Y.Assert.areEqual("\uD55C\uAD6D\uC5B4", Crypto.enc.UTF8.encode(Crypto.enc.UTF8.decode("\uD55C\uAD6D\uC5B4")));
					Y.Assert.areEqual("\u65E5\u672C\u8A9E", Crypto.enc.UTF8.encode(Crypto.enc.UTF8.decode("\u65E5\u672C\u8A9E")));
				},

				"test enc.UTF8.decode": function() {
					Y.Assert.areEqual([0x41E289A2, 0xCE912E00].toString(), Crypto.util.u32(Crypto.enc.UTF8.decode("\u0041\u2262\u0391\u002E")).toString());
					Y.Assert.areEqual([0xED959CEA, 0xB5ADEC96, 0xB4000000].toString(), Crypto.util.u32(Crypto.enc.UTF8.decode("\uD55C\uAD6D\uC5B4")).toString());
					Y.Assert.areEqual([0xE697A5E6, 0x9CACE8AA, 0x9E000000].toString(), Crypto.util.u32(Crypto.enc.UTF8.decode("\u65E5\u672C\u8A9E")).toString());
				},

				"test enc.Hex.encode": function() {
					Y.Assert.areEqual("48656c6c6f2c20576f726c6421", Crypto.enc.Hex.encode(Crypto.enc.Hex.decode("48656c6c6f2c20576f726c6421")));
				},

				"test enc.Hex.decode": function() {
					Y.Assert.areEqual([0x48656C6C, 0x6F2C2057, 0x6F726C64, 0x21000000].toString(), Crypto.util.u32(Crypto.enc.Hex.decode("48656c6c6f2c20576f726c6421")));
				},

				"test enc.Base64.encode": function() {
					Y.Assert.areEqual("FPucA9l+", Crypto.enc.Base64.encode(Crypto.enc.Base64.decode("FPucA9l+")));
					Y.Assert.areEqual("FPucA9k=", Crypto.enc.Base64.encode(Crypto.enc.Base64.decode("FPucA9k=")));
					Y.Assert.areEqual("FPucAw==", Crypto.enc.Base64.encode(Crypto.enc.Base64.decode("FPucAw==")));
				},

				"test enc.Base64.decode": function() {
					Y.Assert.areEqual([0x14FB9C03, 0xD97E0000].toString(), Crypto.util.u32(Crypto.enc.Base64.decode("FPucA9l+")));
					Y.Assert.areEqual([0x14FB9C03, 0xD9000000].toString(), Crypto.util.u32(Crypto.enc.Base64.decode("FPucA9k=")));
					Y.Assert.areEqual([0x14FB9C03].toString(), Crypto.util.u32(Crypto.enc.Base64.decode("FPucAw==")));
				}

			}));

			// Crypto.SHA1 test cases
			Y.Test.Runner.add(new Y.Test.Case({

				"test SHA1": function() {
					Y.Assert.areEqual("da39a3ee5e6b4b0d3255bfef95601890afd80709", Crypto.SHA1(""));
					Y.Assert.areEqual("86f7e437faa5a7fce15d1ddcb9eaeaea377667b8", Crypto.SHA1("a"));
					Y.Assert.areEqual("a9993e364706816aba3e25717850c26c9cd0d89d", Crypto.SHA1("abc"));
					Y.Assert.areEqual("c12252ceda8be8994d5fa0290a47231c1d16aae3", Crypto.SHA1("message digest"));
					Y.Assert.areEqual("32d10c7b8cf96570ca04ce37f2a19d84240d3a89", Crypto.SHA1("abcdefghijklmnopqrstuvwxyz"));
					Y.Assert.areEqual("761c457bf73b14d27e9e9265c46f4b4dda11f940", Crypto.SHA1("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789"));
					Y.Assert.areEqual("50abf5706a150990a08b2c5ea40fa0e585554732", Crypto.SHA1("12345678901234567890123456789012345678901234567890123456789012345678901234567890"));
					Y.Assert.areEqual("0fbe1a75a6fbf4f18585e21734ea341d09457564", Crypto.SHA1("Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque tempor massa sit amet velit consectetur eu pellentesque felis feugiat. Mauris ullamcorper, sapien vel eleifend pulvinar, ligula lacus imperdiet mi, volutpat consequat velit dui a quam. Integer semper orci eget lectus feugiat sed adipiscing urna consectetur. In sem sem, aliquam nec vestibulum ac, aliquet quis elit. Maecenas vehicula tempor enim at dictum. Nam at sem et libero mattis hendrerit non a ante. Aliquam ut pharetra nunc. Quisque massa mi, commodo vitae semper nec, ultricies vitae ligula. Vestibulum in neque sapien. Sed vitae purus sit amet felis interdum porttitor vel sed arcu. Ut quis venenatis eros. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. Aenean pulvinar tellus a nunc egestas cursus. Phasellus eu velit rutrum diam cursus pulvinar. Duis consequat libero quis lectus aliquet eleifend. Curabitur mi libero, dictum at dapibus at, accumsan a dolor. Aliquam metus."));
					Y.Assert.areEqual("85e4c4b3933d5553ebf82090409a9d90226d845c", Crypto.SHA1("12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890"));
					Y.Assert.areEqual(Crypto.enc.ByteStr.encode(Crypto.enc.Hex.decode("da39a3ee5e6b4b0d3255bfef95601890afd80709")), Crypto.SHA1("", { output: Crypto.enc.ByteStr }));
					Y.Assert.areEqual(Crypto.enc.Base64.encode(Crypto.enc.Hex.decode("da39a3ee5e6b4b0d3255bfef95601890afd80709")), Crypto.SHA1("", { output: Crypto.enc.Base64 }));
				}

			}));

			// Initialize console
			new Y.Console({newestOnTop: false, style: "block"}).render("#log");

			// Run the tests
			Y.Test.Runner.run();

		});

	</script>

</head>
<body class="yui-skin-sam">
	<div id="log"></div>
</body>
</html>
